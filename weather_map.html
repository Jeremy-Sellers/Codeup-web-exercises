<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
<!--Bootstrap-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
<!--Bootstrap-->
    <script src="https://api.mapbox.com/mapbox-gl-js/v2.7.0/mapbox-gl.js"></script>

    <style>
        #map{
            width: 100%;
            height:400px;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        header{
            display: flex;
            flex-direction: row;
            justify-content: space-between;
            background-color: deepskyblue;
        }
        section{
            display: flex;
            flex-direction: row;
        }
        ul{
            width: 100%;
        }
        li{
            list-style: none;
            margin: .5em;
            border: 1px solid black;
            border-radius: 5px;
        }
        .date{
            background-color: #b1e0f3;
        }
        .coordinates{
            position: relative;
            bottom: 5px;
            background-color: red;

        }

                                                                                div{}
    </style>
    <!--Mapbox-->
    <link href='https://api.mapbox.com/mapbox-gl-js/v2.7.0/mapbox-gl.css' rel='stylesheet' />
    <!--Mapbox-->
    <title>Weather Map Project</title>
</head>
<body>



<!-------------------------------------HTML---------------------------------------->
<!--Header-->
<header>
    <h3 class="appName">Weather Map</h3>
    <h4 class="cityDisplay">Current city:</h4>
</header>
<!--Header-->

<!--Navbar-->
<nav class="navbar navbar-light bg-light">
    <div class="container-fluid">
        <a class="navbar-brand">Place</a>
        <form class="d-flex">
            <input class="form-control me-2" type="search" placeholder="Search for a City" aria-label="Search">
            <button class="btn btn-outline-success" type="submit">Find</button>
        </form>
    </div>
</nav>
<!--Navbar-->

<!--Cards-->
<section>
    <div class="card m-2" style="width: 50%;">
        <div class="date">
            Date
        </div>
        <ul class="list-group list-group-flush">
            <li class="temperature">An item</li>
            <li class="humidity">A second item</li>
            <li class="pressure">A third item</li>
            <li class="sunrise">A second item</li>
            <li class="sunset">A third item</li>
        </ul>
    </div>
    <div class="card m-2" style="width: 50%;">
        <div class="date">
            Date
        </div>
        <ul class="list-group list-group-flush">
            <li class="temperature">An item</li>
            <li class="humidity">A second item</li>
            <li class="pressure">A third item</li>
            <li class="sunrise">A second item</li>
            <li class="sunset">A third item</li>
        </ul>
    </div>
    <div class="card m-2" style="width: 50%;">
        <div class="date">
            Date
        </div>
        <ul class="list-group list-group-flush">
            <li class="temperature">An item</li>
            <li class="humidity">A second item</li>
            <li class="pressure">A third item</li>
            <li class="sunrise">A second item</li>
            <li class="sunset">A third item</li>
        </ul>
    </div>
    <div class="card m-2" style="width: 50%;">
        <div class="date">
            Date
        </div>
        <ul class="list-group list-group-flush">
            <li class="temperature">An item</li>
            <li class="humidity">A second item</li>
            <li class="pressure">A third item</li>
            <li class="sunrise">A second item</li>
            <li class="sunset">A third item</li>
        </ul>
    </div>
    <div class="card m-2" style="width: 50%;">
        <div class="date">
            Date
        </div>
        <ul class="list-group list-group-flush ">
            <li class="temperature">An item</li>
            <li class="humidity">A second item</li>
            <li class="pressure">A third item</li>
            <li class="sunrise">A second item</li>
            <li class="sunset">A third item</li>
        </ul>
    </div>
</section>
<div id='map'></div>
<pre id="coordinates" class="coordinates"></pre>
<!-------------------------------------HTML---------------------------------------->




<!--jQuery-->
<script src="https://code.jquery.com/jquery-2.2.4.js" integrity="sha256-iT6Q9iMJYuQiMWNd9lDyBUStIq/8PuOW33aOqmvFpqI=" crossorigin="anonymous"></script>
<!--jQuery-->

<!--Mapbox link-->
<script src="js/mapbox-geocoder-utils.js"></script>
<script src="js/keys.js"></script>
<!--Mapbox link-->

<script>


    "use strict"
    mapboxgl.accessToken = MAPBOX_API_TOKEN;
    var coordinates = document.getElementById('coordinates');
        var map = new mapboxgl.Map({//set map to new location based on lng and lat
            container: 'map',//container ID
            style: 'mapbox://styles/mapbox/streets-v11',//style URL
            center: [-98.4951, 29.4246],//starting position[lng,lat]
            zoom: 10//starting zoom
        });


        var marker = new mapboxgl.Marker({
            draggable: true
        })
        .setLngLat([-98.4951,29.4246])
        .addTo(map)

        function onDragEnd(){
            var lngLat = marker.getLngLat();
            coordinates.style.display = 'block';
            coordinates.innerHTML = `Longitude: ${lngLat.lng}<br />Latitude: ${lngLat.lat}`;
        }

        marker.on('dragend',onDragEnd)

    // map.addControl(new
    // mapboxgl.NavigationControl()); adds a zoom bar and drag scroll


    $.get('https://api.openweathermap.org/data/2.5/onecall',{
        lat: 29.4252,
        lon: -98.4916,
        appid: WEATHER_MAP_TOKEN,
        units:"imperial",
        exclude:'minutely,hourly,current,alerts'  //used to exclude certain timeframes
    }).done(function (data){
        console.log(data);
        $('.date').each(function (index){
            var dateMilliseconds = data.daily[index].dt
            var date = new Date(dateMilliseconds * 1000).toDateString()
            $(this).text(date);
        })

        $('.temperature').each(function (index){
            $(this).html('High: '+ data.daily[index].temp.max + 'F'
                + '<br>'
                + 'Low: ' + data.daily[index].temp.min + 'F')
        })

        $('.humidity').each(function (index){
            $(this).text('Humidity:' + data.daily[index].humidity);
        })

        $('.pressure').each(function (index){
            $(this).text('Atmospheric pressure is: ' + data.daily[index].pressure);
        })

        $('.sunrise').each(function (index){
            var sunrise = (data.daily[index].sunrise);
            var sunriseTime = new Date(sunrise * 1000).toLocaleString();
            $(this).text('Sunrise is at: ' + sunriseTime);
        })
        $('.sunset').each(function (index){
            var sunset = (data.daily[index].sunset);
            var sunsetTime = new Date(sunset * 1000).toLocaleString();
            $(this).text('Sunset is at: ' + sunsetTime);
        })

        // pressure,sunrise,sunset
    }).fail(function (jqXhr,status,error){
        console.log(jqXhr);
        console.log(status);
        console.log(error);
    });

// $('.Humidty').text();

</script>

</body>
</html>